webpackJsonp([25],{"I+KP":function(e,t){},dsum:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),l=a.n(s),i=a("NYxO"),n={name:"messageCenter",created:function(){this.initView()},computed:l()({},Object(i.mapState)(["alertMsg","msgSearchQuery"])),data:function(){return{searchList:[{type:"select",label:"消息状态",placeholder:"请选择",key:"readState",selectType:"selectAll",options:[{value:"all",label:"全部"},{value:"0",label:"未读"},{value:"1",label:"已读"}]},{type:"select",label:"消息类型",placeholder:"请选择",key:"type",selectType:"selectAll",options:[{value:"all",label:"全部"},{value:"0",label:"规则变更"},{value:"1",label:"业务通知"},{value:"2",label:"活动通知"},{value:"3",label:"协议变更"},{value:"4",label:"系统功能"},{value:"5",label:"问卷调研"},{value:"6",label:"其他"}]}],mapType:{0:"规则变更",1:"业务通知",2:"活动通知",3:"协议变更",4:"系统功能",5:"问卷调研",6:"其他"},tableList:[],tableReady:!1,searchOpts:{rows:"20",page:"1",readState:null,type:null},msgSize:{total:0,noRead:0},paging:{currentPage:1,pageSizes:[20,30,50,100],pageSize:0,total:0},msgNum:{messageCount:0,unReadCount:0}}},methods:l()({},Object(i.mapActions)(["getMsgList","getMsgNum","setMsgSearchQuery"]),{initView:function(){this.msgSearchQuery.isFocus&&(this.searchOpts=this.msgSearchQuery.query),this.searchMsg()},searchMsg:function(){var e=this;this.getMsgList(this.searchOpts).then(function(t){e.tableList=t.rows||[],e.paging.currentPage=Number(e.searchOpts.page),e.paging.pageSize=Number(e.searchOpts.rows),e.paging.total=Number(t.total),e.getMsgNum().then(function(t){e.msgNum=t}),e.tableReady=!0})},handleSizeChange:function(e){this.searchOpts.rows=e,this.searchMsg()},handleCurrentChange:function(e){this.searchOpts.page=e,this.searchMsg()},tableRowClassName:function(e,t){return t%2==1?"info-row":"positive-row"},ruleDetail:function(e,t,a){var s={isFocus:!0,query:this.searchOpts};this.setMsgSearchQuery(s),this.$router.push({path:"/message/detail",query:{messageId:e.id}})}}),watch:{alertMsg:function(e){e||this.initView()}}},r=a("lsXw"),c=a.n(r);var u=function(e){a("I+KP")},o=a("VU/8")(n,c.a,!1,u,"data-v-fdc582e6",null);t.default=o.exports},lsXw:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._m(0),e._v(" "),a("div",{staticClass:"section"},[a("div",{staticClass:"section-item",staticStyle:{"text-align":"right"}},[a("div",{staticClass:"inline-item fl-l"},[e._v("共"+e._s(e.msgNum.messageCount)+"条，其中未读消息"+e._s(e.msgNum.unReadCount)+"条")]),e._v(" "),e._l(e.searchList,function(t){return a("div",{staticClass:"inline-item"},[a("span",{staticClass:"name-item"},[e._v(e._s(t.label)+"：")]),e._v(" "),a("el-select",{staticClass:"input-item-middle",attrs:{size:"small",placeholder:t.placeholder},model:{value:e.searchOpts[t.key],callback:function(a){e.$set(e.searchOpts,t.key,a)},expression:"searchOpts[item.key]"}},e._l(t.options,function(e){return a("div",{staticClass:"inline-item"},[a("el-option",{attrs:{label:e.label,value:e.value}})],1)}))],1)}),e._v(" "),a("div",{staticClass:"inline-item"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.searchMsg()}}},[e._v("搜索")])],1)],2),e._v(" "),a("div",{staticClass:"section-item section-item-no-padding"},[e.tableReady?a("div",{staticClass:"result-view"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableList,"row-class-name":e.tableRowClassName,"row-key":"id"},on:{"row-click":e.ruleDetail}},[a("el-table-column",{attrs:{prop:"attachmentCount",label:"提示",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.readState?a("i",{staticClass:"ggj-nav-icon"},[e._v("")]):a("i",{staticClass:"ggj-nav-icon"},[e._v("")]),e._v(" "),t.row.attachmentCount>0?a("i",{staticClass:"ggj-nav-icon"},[e._v("")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"消息类型",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e.mapType[t.row.type])+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"theme",label:"主题",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pushTime",label:"时间",width:"240",align:"center"}})],1)],1):e._e()]),e._v(" "),a("div",{staticClass:"pagination-item"},[a("el-pagination",{attrs:{"current-page":e.paging.currentPage,"page-sizes":e.paging.pageSizes,"page-size":e.paging.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.paging.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"title"},[t("span",[this._v("消息中心")])])}]}}});
//# sourceMappingURL=25.bb85a5127d3dfa80558f.js.map